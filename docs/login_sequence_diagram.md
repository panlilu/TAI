# 登录模块时序图

本文档使用Mermaid绘制了登录模块的时序图，展示了用户登录系统的完整流程。

## 登录流程时序图

```mermaid
sequenceDiagram
    actor 用户
    participant 前端 as 前端界面
    participant 认证服务 as 认证服务
    participant 数据库 as 用户数据库
    participant JWT as JWT服务
    
    用户->>前端: 输入用户名和密码
    前端->>前端: 表单验证
    
    alt 表单验证失败
        前端-->>用户: 显示错误信息
    else 表单验证通过
        前端->>认证服务: 发送登录请求
        认证服务->>数据库: 查询用户信息
        
        alt 用户不存在
            数据库-->>认证服务: 返回用户不存在
            认证服务-->>前端: 返回登录失败
            前端-->>用户: 显示"用户名或密码错误"
        else 用户存在
            数据库-->>认证服务: 返回用户信息
            认证服务->>认证服务: 验证密码
            
            alt 密码不正确
                认证服务-->>前端: 返回登录失败
                前端-->>用户: 显示"用户名或密码错误"
            else 密码正确
                认证服务->>JWT: 请求生成令牌
                JWT-->>认证服务: 返回JWT令牌
                认证服务->>数据库: 更新用户最后登录时间
                认证服务-->>前端: 返回JWT令牌和用户信息
                前端->>前端: 存储令牌和用户状态
                前端-->>用户: 显示登录成功，重定向到主页
            end
        end
    end
```

## 说明

1. **用户操作**：用户在登录界面输入用户名和密码
2. **前端验证**：前端进行基本的表单验证（如字段非空、格式正确等）
3. **认证流程**：
   - 服务器查询用户数据库确认用户存在
   - 验证密码是否匹配
   - 生成JWT令牌用于后续请求的身份验证
4. **成功/失败处理**：
   - 失败时向用户展示适当的错误信息
   - 成功时更新用户登录状态并重定向到应用主页 